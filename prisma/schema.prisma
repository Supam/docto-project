// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model ResearchCenter {
  id                Int @id @default(autoincrement())

  centerSymptoms    String[] @unique
  studyFields       Condition[]

  name              String
  addresses         String[]
  phoneNumbers      String[]
  emails            String[]

  notes             String?

  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
}

enum State {
  SCHEDULED
  RECRUITING
  TESTING
  ANALYSING
  COMPLETED
}

model Study {
  id               Int @id @default(autoincrement())

  studySymptoms    String[] @unique
  conditions       Condition[]

  name             String
  patientCurrent   Int
  patientMax       Int
  state            State @default(SCHEDULED)
  paperUrl         String?

  notes            String?

  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}

model Condition {
  id                Int @id @default(autoincrement())

  symptomsPatient   String[]
  conditionsPatient Patient  @relation(fields: [symptomsPatient], references: [patientSymptoms])
  symptomsDoctor    String[]
  conditionsDoctor  Doctor  @relation(fields: [symptomsDoctor], references: [doctorSymptoms])
  symptomsCenter    String[]
  conditionsCenter  ResearchCenter  @relation(fields: [symptomsCenter], references: [centerSymptoms])
  symptomsStudy     String[]
  illnessStudy      Study @relation(fields: [symptomsStudy], references: [studySymptoms])


  name              String @unique
  terminal          Boolean
  partsAffected     String[]
  symptoms          String[]

  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
}

model Patient {
  id                Int @id @default(autoincrement())

  conditions        Condition[]
  patientSymptoms   String[] @unique
  User              User?

  notes             String?

  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
}

model Doctor {
  id                Int @id @default(autoincrement())

  studyFields       Condition[]
  doctorSymptoms    String[] @unique
  User              User?

  notes             String?

  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
}

model User {
  id                Int @id @default(autoincrement())

  userPatient       Int? @unique
  patient           Patient? @relation(fields: [userPatient], references: [id])
  userDoctor        Int? @unique
  doctor            Doctor? @relation(fields: [userDoctor], references: [id])

  email             String @unique
  phoneNumber       String @unique
  username          String @unique
  password          String
  age               Int
  sex               String
  address           String
  nationality       String

  notes             String?

  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
}
